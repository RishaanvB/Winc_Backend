<!-- macro for inputerrors -->
{% macro with_errors(field) %} {% if field.errors %} {% set css_class =
'form-control form-control-lg is-invalid ' + kwargs.pop('class', '') %} {{
field(class=css_class, **kwargs) }}
<div class="invalid-feedback">
  {% for error in field.errors %}
  <small>{{ error|e }}</small>
  {% endfor %}
</div>

{% else %} {{ field(**kwargs) }} {% endif %} {% endmacro %}

<!-- macro for seperate input groups -->

{%- macro product_form_group(name="", input="", col=12, value="",id="",
infotext="", class="form-control border border-2 border-secondary") -%}
<div class="col-lg-{{col}} form-group my-3">
  <div class="input-group input-group-sm">
    <span
      class="
        input-group-text
        bg-secondary
        text-light
        border border-2 border-secondary
      "
      >{{name}}
    </span>
    {{with_errors(input, class=class, value=value, id=id) }}
  </div>
  <div class="form-text">{{infotext}}</div>
</div>
{%- endmacro -%}
<!-- endmacro -->

{% extends "base.html" %} {% block content %}

<!-- start product featurette -->

<div class="featurette container row mx-auto my-4">
  <form
    action="{{url_for('update_product', product_id=product.id)}}"
    method="POST"
    class="col-md-6 g-3 my-4"
  >
    {{ update_product_form.hidden_tag() }}
    <div class="d-flex justify-content-between">
      <h4 class="mb-2 fw-bolder">Update Product</h4>
      <span class="form-group" role="button">
        {{ update_product_form.update_product(class="btn btn-dark text-warning
        fw-bolder") }}
      </span>
    </div>

    <!-- productname -->
    {{product_form_group(input=update_product_form.name, name="Product Name",
    value=product.name)}}
    <!-- price_per_unit -->
    {{product_form_group(input=update_product_form.price_per_unit,
    name="€",value=product.price_per_unit, infotext="Seperate cents with dot :
    10.00")}}
    <!-- stock -->
    {{product_form_group(input=update_product_form.stock,
    name="Quantity",infotext="How many do you want to add?"
    , class="form-control form-select border border-2
    border-secondary")}}
    <!-- tags -->
    {{product_form_group(input=update_product_form.tags, name="Category",
    infotext="Separate Categories By Spaces", value=tags)}}
    <!-- description -->
    {{product_form_group(input=update_product_form.description,value=product.description,
    name="Description", infotext="Whatcha selling?")}}
    <!-- add_product -->
  </form>
  <div class="col-md-6 my-4">
    <div class="d-flex justify-content-between align-items-center">
      <h1 class="featurette-heading text-capitalize mt-0">
        {{product.name}} ID: {{product.id}}
      </h1>
      <h3>€ {{ "%.2f"|format(product.price_per_unit) }}</h3>
    </div>
    <div class="d-flex text-warning">
      <i class="bi bi-star-fill"></i>
      <i class="bi bi-star-fill mx-1"></i>
      <i class="bi bi-star-fill"></i>
      <i class="bi bi-star-half"></i>
    </div>
    <h5 class="text-muted mt-1">Products available: {{product.stock}}</h5>
    <small class="text-muted"
      >Added @ {{format_string(product.date_posted)}}</small
    >
    <h6 class="lead featurette-description mt-3">Description:</h6>
    <p class="m-0">
      {{product.description}} {% if product.description%} {% else%} This product
      does not have a description yet. Quasi omnis animi voluptate accusantium
      hic ad qui doloremque placeat vero expedita debitis rem est, molestias
      voluptatibus nam quod, et, quos quidem laudantium iusto esse provident
      eius. Ullam deleniti laudantium iusto numquam et ducimus repellat,
      maiores, doloremque, ratione consequuntur reiciendis aspernatur inventore?
      {% endif%}
    </p>
    <small class="mt-2 text-primary" style="font-weight: 500"
      >Sold by: {{product.owner.username}}</small
    >
    <button type="button" class="btn btn-warning fs-5">
      <i class="bi bi-cart-plus-fill"></i>
    </button>
  </div>
</div>

{% endblock content %}
